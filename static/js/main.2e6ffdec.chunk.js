(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1187:function(e,t,n){"use strict";n.r(t);var a=n(4),i=n.n(a),r=n(448),o=n.n(r),s=(n(459),n(449));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(s.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},205:function(e,t){},449:function(e,t,n){"use strict";(function(e){var a=n(453),i=n(15),r=n.n(i),o=n(158),s=n(96),l=n(98),c=n(97),u=n(66),p=n(99),m=n(4),d=n.n(m),f=n(244),h=n.n(f),b=(n(717),n(450)),y=n(451),g=n(452),w=n(721)({host:"ipfs.infura.io",port:5001,protocol:"https"}),E=function(t){function n(t){var a;return Object(s.a)(this,n),(a=Object(l.a)(this,Object(c.a)(n).call(this,t))).captureFile=function(t){t.preventDefault();var n=t.target.files[0],i=new window.FileReader;i.readAsArrayBuffer(n),i.onloadend=function(){a.setState({buffer:e(i.result)})}},a.capturePostFile=function(t){t.preventDefault();var n=t.target.files[0],i=new window.FileReader;i.readAsArrayBuffer(n),i.onloadend=function(){a.setState({postBuffer:e(i.result)}),console.log("PB buffer",a.state.postBuffer)}},a.uploadPost=function(e){console.log("Submitting files to IPFS"),w.add(a.state.buffer,function(t,n){console.log("IPFS result",n),t?console.error(t):w.add(a.state.postBuffer,function(t,i){console.log("IPFS result",i),t?console.error(t):(a.setState({loading:!0}),a.state.alexandria.methods.uploadPost(n[0].hash,e,i[0].hash).send({from:a.state.account}).on("transactionHash",function(e){a.setState({loading:!1})}))})})},a.tipPostAuthor=function(e,t){a.setState({loading:!0}),a.state.alexandria.methods.tipPostAuthor(e).send({from:a.state.account,value:t}).on("transactionHash",function(e){a.setState({loading:!1})})},a.state={account:"",Alexandria:null,posts:[],loading:!0},a}return Object(p.a)(n,t),Object(u.a)(n,[{key:"componentWillMount",value:function(){var e=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadWeb3();case 2:return e.next=4,this.loadBlockchainData();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadWeb3",value:function(){var e=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=6;break}return window.web3=new h.a(window.ethereum),e.next=4,window.ethereum.enable();case 4:e.next=7;break;case 6:window.web3?window.web3=new h.a(window.web3.currentProvider):window.alert("Non-Ethereum browser detected. Please enable MetaMask!");case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"loadBlockchainData",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n,i,o,s,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.web3,e.next=3,t.eth.getAccounts();case 3:return n=e.sent,this.setState({account:n[0]}),e.next=7,t.eth.net.getId();case 7:return e.sent,31,"0x292DF9d771537DeF350C4e8B9A2D0E5b210E1Bf5",i=t.eth.Contract(b,"0x292DF9d771537DeF350C4e8B9A2D0E5b210E1Bf5"),this.setState({alexandria:i}),e.next=15,i.methods.postCount().call();case 15:o=e.sent,console.log("Contract object: ",i),this.setState({postCount:o}),s=1;case 19:if(!(s<=o)){e.next=28;break}return e.next=22,i.methods.posts(s).call();case 22:l=e.sent,console.log("POST: ",l),this.setState({posts:[].concat(Object(a.a)(this.state.posts),[l])});case 25:s++,e.next=19;break;case 28:this.setState({posts:this.state.posts.sort(function(e,t){return t.tipAmount-e.tipAmount})}),this.setState({loading:!1}),e.next=33;break;case 32:window.alert("Alexandria contract not deployed to selected network");case 33:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),Object(u.a)(n,[{key:"render",value:function(){return d.a.createElement("div",null,d.a.createElement(y.a,{account:this.state.account}),this.state.loading?d.a.createElement("div",{id:"loader",className:"text-center mt-5"},d.a.createElement("p",null,"Loading... Alexandria requires Metamask linked to RSK Testnet"),d.a.createElement("p",null,"Link ",d.a.createElement("a",{href:"https://developers.rsk.co/wallet/use/metamask/"},"here")," to connect to RSK testnet")):d.a.createElement(g.a,{captureFile:this.captureFile,capturePostFile:this.capturePostFile,uploadPost:this.uploadPost,posts:this.state.posts,tipPostAuthor:this.tipPostAuthor}))}}]),n}(m.Component);t.a=E}).call(this,n(0).Buffer)},450:function(e){e.exports=[{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"string",name:"imageHash",type:"string"},{indexed:!1,internalType:"string",name:"postHash",type:"string"},{indexed:!1,internalType:"string",name:"description",type:"string"},{indexed:!1,internalType:"uint256",name:"tipAmount",type:"uint256"},{indexed:!1,internalType:"address payable",name:"author",type:"address"}],name:"PostCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"string",name:"imageHash",type:"string"},{indexed:!1,internalType:"string",name:"postHash",type:"string"},{indexed:!1,internalType:"string",name:"description",type:"string"},{indexed:!1,internalType:"uint256",name:"tipAmount",type:"uint256"},{indexed:!1,internalType:"address payable",name:"author",type:"address"}],name:"PostTipped",type:"event"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"postCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"posts",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"imageHash",type:"string"},{internalType:"string",name:"postHash",type:"string"},{internalType:"string",name:"description",type:"string"},{internalType:"uint256",name:"tipAmount",type:"uint256"},{internalType:"address payable",name:"author",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"tipPostAuthor",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"string",name:"_imageHash",type:"string"},{internalType:"string",name:"_description",type:"string"},{internalType:"string",name:"_postHash",type:"string"}],name:"uploadPost",outputs:[],stateMutability:"nonpayable",type:"function"}]},451:function(e,t,n){"use strict";var a=n(96),i=n(66),r=n(98),o=n(97),s=n(99),l=n(4),c=n.n(l),u=n(157),p=n.n(u),m=(n(720),function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return c.a.createElement("nav",{className:"navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow"},c.a.createElement("a",{className:"navbar-brand col-sm-3 col-md-2 mr-0",href:"https://basilsage.github.io/blackcoverbook/",target:"_blank",rel:"noopener noreferrer"},"Alexandria"),c.a.createElement("ul",{className:"navbar-nav px-3"},c.a.createElement("li",{className:"nav-item text-nowrap d-none d-sm-none d-sm-block"},c.a.createElement("small",{className:"text-secondary"},c.a.createElement("small",{id:"account"},this.props.account)),this.props.account?c.a.createElement("img",{className:"ml-2",width:"30",height:"30",src:"data:image/png;base64,".concat(new p.a(this.props.account,30).toString())}):c.a.createElement("span",null))))}}]),t}(l.Component));t.a=m},452:function(e,t,n){"use strict";var a=n(96),i=n(66),r=n(98),o=n(97),s=n(99),l=n(4),c=n.n(l),u=n(157),p=n.n(u),m=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"container-fluid mt-5"},c.a.createElement("div",{className:"row"},c.a.createElement("main",{role:"main",className:"col-lg-12 ml-auto mr-auto",style:{maxWidth:"500px"}},c.a.createElement("div",{className:"content mr-auto ml-auto"},c.a.createElement("p",null,"\xa0"),c.a.createElement("h2",null,"Upload book"),c.a.createElement("form",{onSubmit:function(t){t.preventDefault();var n=e.imageDescription.value;e.props.uploadPost(n)}},c.a.createElement("br",null),c.a.createElement("label",{for:"previewImageUpload"},"Preview Image (JPG, PNG)"),c.a.createElement("br",null),c.a.createElement("input",{id:"previewImageUpload",type:"file",title:"",accept:".jpg, .png",onChange:this.props.captureFile}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("label",{for:"previewImageUpload"},"File Upload (PDF)"),c.a.createElement("br",null),c.a.createElement("input",{id:"previewImageUpload",type:"file",title:"",accept:".pdf",onChange:this.props.capturePostFile}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("div",{className:"form-group mr-sm-2"},c.a.createElement("label",{for:"imageDescription"},"Description"),c.a.createElement("input",{id:"imageDescription",type:"text",ref:function(t){e.imageDescription=t},className:"form-control",required:!0})),c.a.createElement("br",null),c.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block btn-lg"},"Upload!")),c.a.createElement("p",null,"\xa0"),this.props.posts.map(function(t,n){return c.a.createElement("div",{className:"card mb-4",key:n},c.a.createElement("div",{className:"card-header"},c.a.createElement("img",{className:"mr-2",width:"30",height:"30",src:"data:image/png;base64,".concat(new p.a(t.author,30).toString())}),c.a.createElement("small",{className:"text-muted"},t.author)),c.a.createElement("ul",{id:"imageList",className:"list-group list-group-flush"},c.a.createElement("li",{className:"list-group-item"},c.a.createElement("p",{className:"text-center"},c.a.createElement("img",{src:"https://ipfs.infura.io/ipfs/".concat(t.imageHash),style:{maxWidth:"420px"}})),c.a.createElement("p",null,t.description),c.a.createElement("form",{action:"https://ipfs.infura.io/ipfs/".concat(t.postHash)},c.a.createElement("input",{type:"submit",value:"Open PDF"}))),c.a.createElement("li",{key:n,className:"list-group-item py-2"},c.a.createElement("small",{className:"float-left mt-1 text-muted"},"TIPS: ",window.web3.utils.fromWei(t.tipAmount.toString(),"Ether")," ETH"),c.a.createElement("button",{className:"btn btn-link btn-sm float-right pt-0",name:t.id,onClick:function(t){var n=window.web3.utils.toWei("0.01","Ether");console.log(t.target.name,n),e.props.tipPostAuthor(t.target.name,n)}},"TIP 0.01 ETH"))))})))))}}]),t}(l.Component);t.a=m},454:function(e,t,n){e.exports=n(1187)},472:function(e,t){},474:function(e,t){},565:function(e,t){},635:function(e,t){},717:function(e,t,n){},720:function(e,t,n){e.exports=n.p+"static/media/photo.d6cbd8e6.png"},852:function(e,t){},886:function(e,t){},888:function(e,t){},907:function(e,t){},909:function(e,t){},916:function(e,t){},918:function(e,t){},924:function(e,t){},925:function(e,t){},939:function(e,t){},941:function(e,t){},949:function(e,t){},951:function(e,t){},957:function(e,t){},965:function(e,t){},967:function(e,t){},986:function(e,t){},988:function(e,t){}},[[454,2,1]]]);
//# sourceMappingURL=main.2e6ffdec.chunk.js.map